{"version":3,"sources":["../../../../../src/webgpu/api/operation/render_pipeline/pipeline_output_targets.spec.ts"],"names":["description","makeTestGroup","range","unreachable","kRenderableColorTextureFormats","kTextureFormatInfo","GPUTest","kTexelRepresentationInfo","kVertexShader","F","getFragmentShaderCode","outputs","resultStrings","outputStructString","i","length","o","fragColorType","suffix","fractionDigits","sampleType","outputType","v","values","map","n","toFixed","componentCount","push","join","g","test","desc","params","u","combine","beginSubcases","expand","p","attachmentCount","beforeAllSubcases","t","info","format","selectDeviceOrSkipTestCase","feature","fn","emptyAttachmentId","componentOrder","writeValue","R","G","B","A","renderTargets","device","createTexture","size","width","height","depthOrArrayLayers","usage","GPUTextureUsage","COPY_SRC","RENDER_ATTACHMENT","pipeline","createRenderPipeline","vertex","module","createShaderModule","code","entryPoint","fragment","targets","primitive","topology","encoder","createCommandEncoder","pass","beginRenderPass","colorAttachments","view","createView","storeOp","clearValue","r","b","a","loadOp","setPipeline","draw","end","queue","submit","finish","expectSingleColor","exp","filter","x","renderTarget","combineWithParams","_result","output","colorSrcFactor","colorDstFactor","alphaSrcFactor","alphaDstFactor","blend","color","srcFactor","dstFactor","operation","alpha"],"mappings":"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","sourcesContent":["export const description = `\n- Test pipeline outputs with different color attachment number, formats, component counts, etc.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { range, unreachable } from '../../../../common/util/util.js';\nimport { kRenderableColorTextureFormats, kTextureFormatInfo } from '../../../capability_info.js';\nimport { GPUTest } from '../../../gpu_test.js';\nimport { kTexelRepresentationInfo } from '../../../util/texture/texel_data.js';\n\nconst kVertexShader = `\n@stage(vertex) fn main(\n@builtin(vertex_index) VertexIndex : u32\n) -> @builtin(position) vec4<f32> {\n  var pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(\n      vec2<f32>(-1.0, -3.0),\n      vec2<f32>(3.0, 1.0),\n      vec2<f32>(-1.0, 1.0));\n  return vec4<f32>(pos[VertexIndex], 0.0, 1.0);\n}\n`;\n\nclass F extends GPUTest {\n  // Build fragment shader based on output value and types\n  // e.g. write to color target 0 a vec4<f32>(1.0, 0.0, 1.0, 1.0) and color target 2 a vec2<u32>(1, 2)\n  // outputs: [\n  //   {\n  //     values: [1, 0, 1, 1],,\n  //     sampleType: 'float',\n  //     componentCount: 4,\n  //   },\n  //   null,\n  //   {\n  //     values: [1, 2],\n  //     sampleType: 'uint',\n  //     componentCount: 2,\n  //   },\n  // ]\n  //\n  // return:\n  // struct Outputs {\n  //     @location(0) o1 : vec4<f32>;\n  //     @location(2) o3 : vec2<u32>;\n  // }\n  // @stage(fragment) fn main() -> Outputs {\n  //     return Outputs(vec4<f32>(1.0, 0.0, 1.0, 1.0), vec4<u32>(1, 2));\n  // }\n  getFragmentShaderCode(\n    outputs: ({\n      values: readonly number[];\n      sampleType: GPUTextureSampleType;\n      componentCount: number;\n    } | null)[]\n  ): string {\n    const resultStrings = [] as string[];\n    let outputStructString = '';\n\n    for (let i = 0; i < outputs.length; i++) {\n      const o = outputs[i];\n      if (o === null) {\n        continue;\n      }\n\n      let fragColorType;\n      let suffix;\n      let fractionDigits = 0;\n      switch (o.sampleType) {\n        case 'sint':\n          fragColorType = 'i32';\n          suffix = '';\n          break;\n        case 'uint':\n          fragColorType = 'u32';\n          suffix = 'u';\n          break;\n        case 'float':\n        case 'unfilterable-float':\n          fragColorType = 'f32';\n          suffix = '';\n          fractionDigits = 4;\n          break;\n        default:\n          unreachable();\n      }\n\n      let outputType;\n      const v = o.values.map(n => n.toFixed(fractionDigits));\n      switch (o.componentCount) {\n        case 1:\n          outputType = fragColorType;\n          resultStrings.push(`${v[0]}${suffix}`);\n          break;\n        case 2:\n          outputType = `vec2<${fragColorType}>`;\n          resultStrings.push(`${outputType}(${v[0]}${suffix}, ${v[1]}${suffix})`);\n          break;\n        case 3:\n          outputType = `vec3<${fragColorType}>`;\n          resultStrings.push(`${outputType}(${v[0]}${suffix}, ${v[1]}${suffix}, ${v[2]}${suffix})`);\n          break;\n        case 4:\n          outputType = `vec4<${fragColorType}>`;\n          resultStrings.push(\n            `${outputType}(${v[0]}${suffix}, ${v[1]}${suffix}, ${v[2]}${suffix}, ${v[3]}${suffix})`\n          );\n          break;\n        default:\n          unreachable();\n      }\n\n      outputStructString += `@location(${i}) o${i} : ${outputType},\\n`;\n    }\n\n    return `\n    struct Outputs {\n      ${outputStructString}\n    }\n\n    @stage(fragment) fn main() -> Outputs {\n        return Outputs(${resultStrings.join(',')});\n    }`;\n  }\n}\n\nexport const g = makeTestGroup(F);\n\ng.test('color,attachments')\n  .desc(`Test that pipeline with  sparse color attachments write values correctly.`)\n  .params(u =>\n    u\n      .combine('format', kRenderableColorTextureFormats)\n      .beginSubcases()\n      .combine('attachmentCount', [2, 3, 4])\n      .expand('emptyAttachmentId', p => range(p.attachmentCount, i => i))\n  )\n  .beforeAllSubcases(async t => {\n    const info = kTextureFormatInfo[t.params.format];\n    await t.selectDeviceOrSkipTestCase(info.feature);\n  })\n  .fn(async t => {\n    const { format, attachmentCount, emptyAttachmentId } = t.params;\n    const componentCount = kTexelRepresentationInfo[format].componentOrder.length;\n    const info = kTextureFormatInfo[format];\n\n    const writeValue =\n      info.sampleType === 'float' ? { R: 0.2, G: 0.6, B: 0.8, A: 1 } : { R: 2, G: 4, B: 8, A: 16 };\n\n    const renderTargets = range(attachmentCount, () =>\n      t.device.createTexture({\n        format,\n        size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n        usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n      })\n    );\n    const pipeline = t.device.createRenderPipeline({\n      vertex: {\n        module: t.device.createShaderModule({\n          code: kVertexShader,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: t.device.createShaderModule({\n          code: t.getFragmentShaderCode(\n            range(attachmentCount, i =>\n              i === emptyAttachmentId\n                ? null\n                : {\n                    values: [writeValue.R, writeValue.G, writeValue.B, writeValue.A],\n                    sampleType: info.sampleType,\n                    componentCount,\n                  }\n            )\n          ),\n        }),\n        entryPoint: 'main',\n        targets: range(attachmentCount, i => (i === emptyAttachmentId ? null : { format })),\n      },\n      primitive: { topology: 'triangle-list' },\n    });\n\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: range(attachmentCount, i =>\n        i === emptyAttachmentId\n          ? null\n          : {\n              view: renderTargets[i].createView(),\n              storeOp: 'store',\n              clearValue: { r: 0.5, g: 0.5, b: 0.5, a: 0.5 },\n              loadOp: 'clear',\n            }\n      ),\n    });\n    pass.setPipeline(pipeline);\n    pass.draw(3);\n    pass.end();\n    t.device.queue.submit([encoder.finish()]);\n\n    for (let i = 0; i < attachmentCount; i++) {\n      if (i === emptyAttachmentId) {\n        continue;\n      }\n      t.expectSingleColor(renderTargets[i], format, {\n        size: [1, 1, 1],\n        exp: writeValue,\n      });\n    }\n  });\n\ng.test('color,component_count')\n  .desc(\n    `Test that extra components of the output (e.g. f32, vec2<f32>, vec3<f32>, vec4<f32>) are discarded.`\n  )\n  .params(u =>\n    u\n      .combine('format', kRenderableColorTextureFormats)\n      .beginSubcases()\n      .combine('componentCount', [1, 2, 3, 4])\n      .filter(x => x.componentCount >= kTexelRepresentationInfo[x.format].componentOrder.length)\n  )\n  .beforeAllSubcases(async t => {\n    const info = kTextureFormatInfo[t.params.format];\n    await t.selectDeviceOrSkipTestCase(info.feature);\n  })\n  .fn(async t => {\n    const { format, componentCount } = t.params;\n    const info = kTextureFormatInfo[format];\n\n    // expected RGBA values\n    // extra channels are discarded\n    const values = [0, 1, 0, 1];\n\n    const renderTarget = t.device.createTexture({\n      format,\n      size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n      usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n    });\n\n    const pipeline = t.device.createRenderPipeline({\n      vertex: {\n        module: t.device.createShaderModule({\n          code: kVertexShader,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: t.device.createShaderModule({\n          code: t.getFragmentShaderCode([\n            {\n              values,\n              sampleType: info.sampleType,\n              componentCount,\n            },\n          ]),\n        }),\n        entryPoint: 'main',\n        targets: [{ format }],\n      },\n      primitive: { topology: 'triangle-list' },\n    });\n\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          storeOp: 'store',\n          clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n        },\n      ],\n    });\n    pass.setPipeline(pipeline);\n    pass.draw(3);\n    pass.end();\n    t.device.queue.submit([encoder.finish()]);\n\n    t.expectSingleColor(renderTarget, format, {\n      size: [1, 1, 1],\n      exp: { R: values[0], G: values[1], B: values[2], A: values[3] },\n    });\n  });\n\ng.test('color,component_count,blend')\n  .desc(\n    `Test that blending behaves correctly when:\n- fragment output has no alpha, but the src alpha is not used for the blend operation indicated by blend factors\n- attachment format has no alpha, and the dst alpha should be assumed as 1\n\nThe attachment has a load value of [1, 0, 0, 1]\n`\n  )\n  .params(u =>\n    u\n      .combine('format', ['r8unorm', 'rg8unorm', 'rgba8unorm', 'bgra8unorm'] as const)\n      .beginSubcases()\n      // _result is expected values in the color attachment (extra channels are discarded)\n      // output is the fragment shader output vector\n      // 0.498 -> 0x7f, 0.502 -> 0x80\n      .combineWithParams([\n        // fragment output has no alpha\n        {\n          _result: [0, 0, 0, 0],\n          output: [0],\n          colorSrcFactor: 'one',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0, 0, 0, 0],\n          output: [0],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [1, 0, 0, 0],\n          output: [0],\n          colorSrcFactor: 'one-minus-dst-alpha',\n          colorDstFactor: 'dst-alpha',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'one',\n        },\n        {\n          _result: [0.498, 0, 0, 0],\n          output: [0.498],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'one',\n        },\n        {\n          _result: [0, 1, 0, 0],\n          output: [0, 1],\n          colorSrcFactor: 'one',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0, 1, 0, 0],\n          output: [0, 1],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [1, 0, 0, 0],\n          output: [0, 1],\n          colorSrcFactor: 'one-minus-dst-alpha',\n          colorDstFactor: 'dst-alpha',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'one',\n        },\n        {\n          _result: [0, 1, 0, 0],\n          output: [0, 1, 0],\n          colorSrcFactor: 'one',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0, 1, 0, 0],\n          output: [0, 1, 0],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [1, 0, 0, 0],\n          output: [0, 1, 0],\n          colorSrcFactor: 'one-minus-dst-alpha',\n          colorDstFactor: 'dst-alpha',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'one',\n        },\n        // fragment output has alpha\n        {\n          _result: [0.502, 1, 0, 0.498],\n          output: [0, 1, 0, 0.498],\n          colorSrcFactor: 'one',\n          colorDstFactor: 'one-minus-src-alpha',\n          alphaSrcFactor: 'one',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0.502, 0.498, 0, 0.498],\n          output: [0, 1, 0, 0.498],\n          colorSrcFactor: 'src-alpha',\n          colorDstFactor: 'one-minus-src-alpha',\n          alphaSrcFactor: 'one',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0, 1, 0, 0.498],\n          output: [0, 1, 0, 0.498],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'one',\n          alphaDstFactor: 'zero',\n        },\n        {\n          _result: [0, 1, 0, 0.498],\n          output: [0, 1, 0, 0.498],\n          colorSrcFactor: 'dst-alpha',\n          colorDstFactor: 'zero',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'src',\n        },\n        {\n          _result: [1, 0, 0, 1],\n          output: [0, 1, 0, 0.498],\n          colorSrcFactor: 'one-minus-dst-alpha',\n          colorDstFactor: 'dst-alpha',\n          alphaSrcFactor: 'zero',\n          alphaDstFactor: 'dst-alpha',\n        },\n      ] as const)\n      .filter(x => x.output.length >= kTexelRepresentationInfo[x.format].componentOrder.length)\n  )\n  .beforeAllSubcases(async t => {\n    const info = kTextureFormatInfo[t.params.format];\n    await t.selectDeviceOrSkipTestCase(info.feature);\n  })\n  .fn(async t => {\n    const {\n      format,\n      _result,\n      output,\n      colorSrcFactor,\n      colorDstFactor,\n      alphaSrcFactor,\n      alphaDstFactor,\n    } = t.params;\n    const componentCount = output.length;\n    const info = kTextureFormatInfo[format];\n\n    const renderTarget = t.device.createTexture({\n      format,\n      size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n      usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n    });\n\n    const pipeline = t.device.createRenderPipeline({\n      vertex: {\n        module: t.device.createShaderModule({\n          code: kVertexShader,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: t.device.createShaderModule({\n          code: t.getFragmentShaderCode([\n            {\n              values: output,\n              sampleType: info.sampleType,\n              componentCount,\n            },\n          ]),\n        }),\n        entryPoint: 'main',\n        targets: [\n          {\n            format,\n            blend: {\n              color: {\n                srcFactor: colorSrcFactor,\n                dstFactor: colorDstFactor,\n                operation: 'add',\n              },\n              alpha: {\n                srcFactor: alphaSrcFactor,\n                dstFactor: alphaDstFactor,\n                operation: 'add',\n              },\n            },\n          },\n        ],\n      },\n      primitive: { topology: 'triangle-list' },\n    });\n\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          storeOp: 'store',\n          clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n        },\n      ],\n    });\n    pass.setPipeline(pipeline);\n    pass.draw(3);\n    pass.end();\n    t.device.queue.submit([encoder.finish()]);\n\n    t.expectSingleColor(renderTarget, format, {\n      size: [1, 1, 1],\n      exp: { R: _result[0], G: _result[1], B: _result[2], A: _result[3] },\n    });\n  });\n"],"file":"pipeline_output_targets.spec.js"}