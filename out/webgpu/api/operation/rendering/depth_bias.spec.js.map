{"version":3,"file":"depth_bias.spec.js","names":["description","makeTestGroup","unreachable","kTextureFormatInfo","GPUTest","kValue","TexelView","textureContentIsOKByT2B","QuadAngle","kPointTwoFiveBiasForPointTwoFiveZOnFloat","DepthBiasTest","runDepthBiasTestInternal","depthFormat","quadAngle","bias","biasSlopeScale","biasClamp","initialDepth","renderTargetFormat","depthFormatInfo","vertexShaderCode","Flat","TiltedX","renderTarget","device","createTexture","format","size","width","height","depthOrArrayLayers","usage","GPUTextureUsage","COPY_SRC","RENDER_ATTACHMENT","depthTexture","sampleCount","mipLevelCount","depthStencilAttachment","view","createView","depthLoadOp","depth","undefined","depthStoreOp","stencilLoadOp","stencil","stencilStoreOp","depthClearValue","encoder","createCommandEncoder","pass","beginRenderPass","colorAttachments","storeOp","loadOp","depthCompare","testState","depthWriteEnabled","depthBias","depthBiasSlopeScale","depthBiasClamp","testPipeline","createRenderPipelineForTest","setPipeline","draw","end","queue","submit","finish","runDepthBiasTest","expectedDepth","expColor","Depth","expTexelView","fromTexelsAsColors","coords","result","texture","maxDiffULPsForFloatFormat","eventualExpectOK","trackForCleanup","runDepthBiasTestFor24BitFormat","expectedColor","R","G","B","A","maxDiffULPsForNormFormat","vertex","depthStencil","createRenderPipeline","layout","module","createShaderModule","code","entryPoint","fragment","targets","g","test","desc","params","u","combineWithParams","f32","infinity","positive","negative","fn","t","combine","Float32Array"],"sources":["../../../../../src/webgpu/api/operation/rendering/depth_bias.spec.ts"],"sourcesContent":["export const description = `\nTests render results with different depth bias values like 'positive', 'negative', 'infinity',\n'slope', 'clamp', etc.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { unreachable } from '../../../../common/util/util.js';\nimport {\n  DepthStencilFormat,\n  EncodableTextureFormat,\n  kTextureFormatInfo,\n} from '../../../capability_info.js';\nimport { GPUTest } from '../../../gpu_test.js';\nimport { kValue } from '../../../util/constants.js';\nimport { TexelView } from '../../../util/texture/texel_view.js';\nimport { textureContentIsOKByT2B } from '../../../util/texture/texture_ok.js';\n\nenum QuadAngle {\n  Flat,\n  TiltedX,\n}\n\n// Floating point depth buffers use the following formula to calculate bias\n// bias = depthBias * 2 ** (exponent(max z of primitive) - number of bits in mantissa) +\n//        slopeScale * maxSlope\n// https://docs.microsoft.com/en-us/windows/win32/direct3d11/d3d10-graphics-programming-guide-output-merger-stage-depth-bias\n// https://www.khronos.org/registry/vulkan/specs/1.2-extensions/man/html/vkCmdSetDepthBias.html\n// https://developer.apple.com/documentation/metal/mtlrendercommandencoder/1516269-setdepthbias\n//\n// To get a final bias of 0.25 for primitives with z = 0.25, we can use\n// depthBias = 0.25 / (2 ** (-2 - 23)) = 8388608.\nconst kPointTwoFiveBiasForPointTwoFiveZOnFloat = 8388608;\n\nclass DepthBiasTest extends GPUTest {\n  runDepthBiasTestInternal(\n    depthFormat: DepthStencilFormat,\n    {\n      quadAngle,\n      bias,\n      biasSlopeScale,\n      biasClamp,\n      initialDepth,\n    }: {\n      quadAngle: QuadAngle;\n      bias: number;\n      biasSlopeScale: number;\n      biasClamp: number;\n      initialDepth: number;\n    }\n  ): { renderTarget: GPUTexture; depthTexture: GPUTexture } {\n    const renderTargetFormat = 'rgba8unorm';\n    const depthFormatInfo = kTextureFormatInfo[depthFormat];\n\n    let vertexShaderCode: string;\n    switch (quadAngle) {\n      case QuadAngle.Flat:\n        // Draw a square at z = 0.25.\n        vertexShaderCode = `\n          @vertex\n          fn main(@builtin(vertex_index) VertexIndex : u32) -> @builtin(position) vec4<f32> {\n            var pos = array<vec2<f32>, 6>(\n            vec2<f32>(-1.0, -1.0),\n            vec2<f32>( 1.0, -1.0),\n            vec2<f32>(-1.0,  1.0),\n            vec2<f32>(-1.0,  1.0),\n            vec2<f32>( 1.0, -1.0),\n            vec2<f32>( 1.0,  1.0));\n            return vec4<f32>(pos[VertexIndex], 0.25, 1.0);\n          }\n          `;\n        break;\n      case QuadAngle.TiltedX:\n        // Draw a square ranging from 0 to 0.5, bottom to top.\n        vertexShaderCode = `\n          @vertex\n          fn main(@builtin(vertex_index) VertexIndex : u32) -> @builtin(position) vec4<f32> {\n            var pos = array<vec3<f32>, 6>(\n            vec3<f32>(-1.0, -1.0, 0.0),\n            vec3<f32>( 1.0, -1.0, 0.0),\n            vec3<f32>(-1.0,  1.0, 0.5),\n            vec3<f32>(-1.0,  1.0, 0.5),\n            vec3<f32>( 1.0, -1.0, 0.0),\n            vec3<f32>( 1.0,  1.0, 0.5));\n            return vec4<f32>(pos[VertexIndex], 1.0);\n          }\n          `;\n        break;\n      default:\n        unreachable();\n    }\n\n    const renderTarget = this.device.createTexture({\n      format: renderTargetFormat,\n      size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n      usage: GPUTextureUsage.COPY_SRC | GPUTextureUsage.RENDER_ATTACHMENT,\n    });\n\n    const depthTexture = this.device.createTexture({\n      size: { width: 1, height: 1, depthOrArrayLayers: 1 },\n      format: depthFormat,\n      sampleCount: 1,\n      mipLevelCount: 1,\n      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,\n    });\n\n    const depthStencilAttachment: GPURenderPassDepthStencilAttachment = {\n      view: depthTexture.createView(),\n      depthLoadOp: depthFormatInfo.depth ? 'clear' : undefined,\n      depthStoreOp: depthFormatInfo.depth ? 'store' : undefined,\n      stencilLoadOp: depthFormatInfo.stencil ? 'clear' : undefined,\n      stencilStoreOp: depthFormatInfo.stencil ? 'store' : undefined,\n      depthClearValue: initialDepth,\n    };\n\n    const encoder = this.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTarget.createView(),\n          storeOp: 'store',\n          loadOp: 'load',\n        },\n      ],\n      depthStencilAttachment,\n    });\n\n    let depthCompare: GPUCompareFunction = 'always';\n    if (depthFormat !== 'depth32float') {\n      depthCompare = 'greater';\n    }\n\n    const testState = {\n      format: depthFormat,\n      depthCompare,\n      depthWriteEnabled: true,\n      depthBias: bias,\n      depthBiasSlopeScale: biasSlopeScale,\n      depthBiasClamp: biasClamp,\n    } as const;\n\n    // Draw a square with the given depth state and bias values.\n    const testPipeline = this.createRenderPipelineForTest(vertexShaderCode, testState);\n    pass.setPipeline(testPipeline);\n    pass.draw(6);\n    pass.end();\n    this.device.queue.submit([encoder.finish()]);\n\n    return { renderTarget, depthTexture };\n  }\n\n  runDepthBiasTest(\n    depthFormat: EncodableTextureFormat & DepthStencilFormat,\n    {\n      quadAngle,\n      bias,\n      biasSlopeScale,\n      biasClamp,\n      expectedDepth,\n    }: {\n      quadAngle: QuadAngle;\n      bias: number;\n      biasSlopeScale: number;\n      biasClamp: number;\n      expectedDepth: number;\n    }\n  ) {\n    const { renderTarget, depthTexture } = this.runDepthBiasTestInternal(depthFormat, {\n      quadAngle,\n      bias,\n      biasSlopeScale,\n      biasClamp,\n      initialDepth: 0,\n    });\n\n    const expColor = { Depth: expectedDepth };\n    const expTexelView = TexelView.fromTexelsAsColors(depthFormat, coords => expColor);\n\n    const result = textureContentIsOKByT2B(\n      this,\n      { texture: depthTexture },\n      [1, 1],\n      { expTexelView },\n      { maxDiffULPsForFloatFormat: 1 }\n    );\n    this.eventualExpectOK(result);\n    this.trackForCleanup(renderTarget);\n    this.trackForCleanup(depthTexture);\n  }\n\n  runDepthBiasTestFor24BitFormat(\n    depthFormat: DepthStencilFormat,\n    {\n      quadAngle,\n      bias,\n      biasSlopeScale,\n      biasClamp,\n      expectedColor,\n    }: {\n      quadAngle: QuadAngle;\n      bias: number;\n      biasSlopeScale: number;\n      biasClamp: number;\n      expectedColor: Float32Array;\n    }\n  ) {\n    const { renderTarget, depthTexture } = this.runDepthBiasTestInternal(depthFormat, {\n      quadAngle,\n      bias,\n      biasSlopeScale,\n      biasClamp,\n      initialDepth: 0.4,\n    });\n\n    const renderTargetFormat = 'rgba8unorm';\n    const expColor = {\n      R: expectedColor[0],\n      G: expectedColor[1],\n      B: expectedColor[2],\n      A: expectedColor[3],\n    };\n    const expTexelView = TexelView.fromTexelsAsColors(renderTargetFormat, coords => expColor);\n\n    const result = textureContentIsOKByT2B(\n      this,\n      { texture: renderTarget },\n      [1, 1],\n      { expTexelView },\n      { maxDiffULPsForNormFormat: 1 }\n    );\n    this.eventualExpectOK(result);\n    this.trackForCleanup(renderTarget);\n    this.trackForCleanup(depthTexture);\n  }\n\n  createRenderPipelineForTest(\n    vertex: string,\n    depthStencil: GPUDepthStencilState\n  ): GPURenderPipeline {\n    return this.device.createRenderPipeline({\n      layout: 'auto',\n      vertex: {\n        module: this.device.createShaderModule({\n          code: vertex,\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        targets: [{ format: 'rgba8unorm' }],\n        module: this.device.createShaderModule({\n          code: `\n            @fragment fn main() -> @location(0) vec4<f32> {\n              return vec4<f32>(1.0, 0.0, 0.0, 1.0);\n            }`,\n        }),\n        entryPoint: 'main',\n      },\n      depthStencil,\n    });\n  }\n}\n\nexport const g = makeTestGroup(DepthBiasTest);\n\ng.test('depth_bias')\n  .desc(\n    `\n  Tests that a square with different depth bias values like 'positive', 'negative', 'infinity',\n  'slope', 'clamp', etc. is drawn as expected.\n  `\n  )\n  .params(u =>\n    u //\n      .combineWithParams([\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: kPointTwoFiveBiasForPointTwoFiveZOnFloat,\n          biasSlopeScale: 0,\n          biasClamp: 0,\n          expectedDepth: 0.5,\n        },\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: kPointTwoFiveBiasForPointTwoFiveZOnFloat,\n          biasSlopeScale: 0,\n          biasClamp: 0.125,\n          expectedDepth: 0.375,\n        },\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: -kPointTwoFiveBiasForPointTwoFiveZOnFloat,\n          biasSlopeScale: 0,\n          biasClamp: 0.125,\n          expectedDepth: 0,\n        },\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: -kPointTwoFiveBiasForPointTwoFiveZOnFloat,\n          biasSlopeScale: 0,\n          biasClamp: -0.125,\n          expectedDepth: 0.125,\n        },\n        {\n          quadAngle: QuadAngle.TiltedX,\n          bias: 0,\n          biasSlopeScale: 0,\n          biasClamp: 0,\n          expectedDepth: 0.25,\n        },\n        {\n          quadAngle: QuadAngle.TiltedX,\n          bias: 0,\n          biasSlopeScale: 1,\n          biasClamp: 0,\n          expectedDepth: 0.75,\n        },\n        {\n          quadAngle: QuadAngle.TiltedX,\n          bias: 0,\n          biasSlopeScale: -0.5,\n          biasClamp: 0,\n          expectedDepth: 0,\n        },\n        {\n          quadAngle: QuadAngle.TiltedX,\n          bias: 0,\n          biasSlopeScale: kValue.f32.infinity.positive,\n          biasClamp: 0,\n          expectedDepth: 1,\n        },\n        {\n          quadAngle: QuadAngle.TiltedX,\n          bias: 0,\n          biasSlopeScale: kValue.f32.infinity.negative,\n          biasClamp: 0,\n          expectedDepth: 0,\n        },\n      ] as const)\n  )\n  .fn(async t => {\n    t.runDepthBiasTest('depth32float', t.params);\n  });\n\ng.test('depth_bias_24bit_format')\n  .desc(\n    `\n  Tests that a square with different depth bias values like 'positive', 'negative',\n  'slope', 'clamp', etc. is drawn as expected with 24 bit depth format.\n\n  TODO: Enhance these tests by reading back the depth (emulating the copy using texture sampling)\n  and checking the result directly, like the non-24-bit depth tests, instead of just relying on\n  whether the depth test passes or fails.\n  `\n  )\n  .params(u =>\n    u //\n      .combine('format', ['depth24plus', 'depth24plus-stencil8'] as const)\n      .combineWithParams([\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: 0.25 * (1 << 25),\n          biasSlopeScale: 0,\n          biasClamp: 0,\n          expectedColor: new Float32Array([1.0, 0.0, 0.0, 1.0]),\n        },\n        {\n          quadAngle: QuadAngle.TiltedX,\n          bias: 0.25 * (1 << 25),\n          biasSlopeScale: 1,\n          biasClamp: 0,\n          expectedColor: new Float32Array([1.0, 0.0, 0.0, 1.0]),\n        },\n        {\n          quadAngle: QuadAngle.Flat,\n          bias: 0.25 * (1 << 25),\n          biasSlopeScale: 0,\n          biasClamp: 0.1,\n          expectedColor: new Float32Array([0.0, 0.0, 0.0, 0.0]),\n        },\n      ] as const)\n  )\n  .fn(async t => {\n    const { format } = t.params;\n    t.runDepthBiasTestFor24BitFormat(format, t.params);\n  });\n"],"mappings":"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"}