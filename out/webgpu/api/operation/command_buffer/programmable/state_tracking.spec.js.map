{"version":3,"sources":["../../../../../../src/webgpu/api/operation/command_buffer/programmable/state_tracking.spec.ts"],"names":["description","makeTestGroup","GPUConst","kProgrammableEncoderTypes","ProgrammableStateTest","g","kBufferUsage","BufferUsage","COPY_SRC","STORAGE","test","desc","params","u","combine","beginSubcases","a","b","out","fn","t","encoderType","groupIndices","pipeline","createBindingStatePipeline","makeBufferWithContents","Int32Array","bindGroupFactories","i","createBindGroup","encoder","validateFinishAndSubmit","createEncoder","setPipeline","setBindGroup","dispatchOrDraw","expectGPUBufferValuesEqual","setOrder","length","combineWithParams","setBefore","setAfter","ab","badOut","c","pipelineA","pipelineB","outA","outB"],"mappings":";AAAA;AACA,GADA,OAAO,MAAMA,WAAW,GAAI;AAC5B;AACA;AACA,CAHO,CAKP,SAASC,aAAT,QAA8B,+CAA9B;AACA,SAASC,QAAT,QAAyB,0BAAzB;AACA,SAASC,yBAAT,QAA0C,0CAA1C;;AAEA,SAASC,qBAAT,QAAsC,8BAAtC;;AAEA,OAAO,MAAMC,CAAC,GAAGJ,aAAa,CAACG,qBAAD,CAAvB;;AAEP,MAAME,YAAY,GAAGJ,QAAQ,CAACK,WAAT,CAAqBC,QAArB,GAAgCN,QAAQ,CAACK,WAAT,CAAqBE,OAA1E;;AAEAJ,CAAC,CAACK,IAAF,CAAO,oBAAP;AACGC,IADH;AAEK;AACL;AACA;AACA,GALA;;AAOGC,MAPH,CAOU,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAD,CACEC,OADH,CACW,aADX,EAC0BX,yBAD1B;AAEGY,aAFH;AAGGD,OAHH,CAGW,cAHX,EAG2B;AACvB,EAAEE,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EADuB;AAEvB,EAAEF,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EAFuB;AAGvB,EAAEF,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EAHuB;AAIvB,EAAEF,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EAJuB;AAKvB,EAAEF,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EALuB;AAMvB,EAAEF,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EANuB,CAH3B,CARJ;;;AAoBGC,EApBH,CAoBM,MAAMC,CAAN,IAAW;AACb,QAAM,EAAEC,WAAF,EAAeC,YAAf,KAAgCF,CAAC,CAACR,MAAxC;;AAEA,QAAMW,QAAQ,GAAGH,CAAC,CAACI,0BAAF,CAA6BH,WAA7B,EAA0CC,YAA1C,CAAjB;;AAEA,QAAMJ,GAAG,GAAGE,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAZ;AACA,QAAMqB,kBAAkB,GAAG;AACzBX,IAAAA,CAAC,EAAE,CAACY,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAFuB;AAGzBX,IAAAA,CAAC,EAAE,CAACW,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAJuB;AAKzBV,IAAAA,GAAG,EAAGU,CAAD,IAAeR,CAAC,CAACS,eAAF,CAAkBX,GAAlB,EAAuBU,CAAvB,CALK,EAA3B;;;AAQA,QAAM,EAAEE,OAAF,EAAWC,uBAAX,KAAuCX,CAAC,CAACY,aAAF,CAAgBX,WAAhB,CAA7C;;AAEAD,EAAAA,CAAC,CAACa,WAAF,CAAcH,OAAd,EAAuBP,QAAvB;AACAH,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwBR,YAAY,CAACN,CAArC,EAAwCW,kBAAkB,CAACX,CAA3D;AACAI,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwBR,YAAY,CAACL,CAArC,EAAwCU,kBAAkB,CAACV,CAA3D;AACAG,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwBR,YAAY,CAACJ,GAArC,EAA0CS,kBAAkB,CAACT,GAA7D;AACAE,EAAAA,CAAC,CAACe,cAAF,CAAiBL,OAAjB;AACAC,EAAAA,uBAAuB,CAAC,IAAD,EAAO,IAAP,CAAvB;;AAEAX,EAAAA,CAAC,CAACgB,0BAAF,CAA6BlB,GAA7B,EAAkC,IAAIQ,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAlC;AACD,CA5CH;;AA8CArB,CAAC,CAACK,IAAF,CAAO,kBAAP;AACGC,IADH;AAEK;AACL;AACA,GAJA;;AAMGC,MANH,CAMU,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAD,CACEC,OADH,CACW,aADX,EAC0BX,yBAD1B;AAEGY,aAFH;AAGGD,OAHH,CAGW,UAHX,EAGuB;AACnB,CAAC,GAAD,EAAM,GAAN,EAAW,KAAX,CADmB;AAEnB,CAAC,GAAD,EAAM,KAAN,EAAa,GAAb,CAFmB;AAGnB,CAAC,KAAD,EAAQ,GAAR,EAAa,GAAb,CAHmB;AAInB,CAAC,GAAD,EAAM,GAAN,EAAW,KAAX,CAJmB;AAKnB,CAAC,GAAD,EAAM,KAAN,EAAa,GAAb,CALmB;AAMnB,CAAC,KAAD,EAAQ,GAAR,EAAa,GAAb,CANmB,CAHvB,CAPJ;;;AAmBGK,EAnBH,CAmBM,MAAMC,CAAN,IAAW;AACb,QAAM,EAAEC,WAAF,EAAegB,QAAf,KAA4BjB,CAAC,CAACR,MAApC;;AAEA,QAAMU,YAAY,GAAG,EAAEN,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EAArB;AACA,QAAMK,QAAQ,GAAGH,CAAC,CAACI,0BAAF,CAA6BH,WAA7B,EAA0CC,YAA1C,CAAjB;;AAEA,QAAMJ,GAAG,GAAGE,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAZ;AACA,QAAMqB,kBAAkB,GAAG;AACzBX,IAAAA,CAAC,EAAE,CAACY,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAFuB;AAGzBX,IAAAA,CAAC,EAAE,CAACW,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAJuB;AAKzBV,IAAAA,GAAG,EAAGU,CAAD,IAAeR,CAAC,CAACS,eAAF,CAAkBX,GAAlB,EAAuBU,CAAvB,CALK,EAA3B;;;AAQA,QAAM,EAAEE,OAAF,EAAWC,uBAAX,KAAuCX,CAAC,CAACY,aAAF,CAAgBX,WAAhB,CAA7C;AACAD,EAAAA,CAAC,CAACa,WAAF,CAAcH,OAAd,EAAuBP,QAAvB;;AAEA,OAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGS,QAAQ,CAACC,MAA7B,EAAqC,EAAEV,CAAvC,EAA0C;AACxCR,IAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwBR,YAAY,CAACe,QAAQ,CAACT,CAAD,CAAT,CAApC,EAAmDD,kBAAkB,CAACU,QAAQ,CAACT,CAAD,CAAT,CAArE;AACD;;AAEDR,EAAAA,CAAC,CAACe,cAAF,CAAiBL,OAAjB;AACAC,EAAAA,uBAAuB,CAAC,IAAD,EAAO,IAAP,CAAvB;;AAEAX,EAAAA,CAAC,CAACgB,0BAAF,CAA6BlB,GAA7B,EAAkC,IAAIQ,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAlC;AACD,CA7CH;;AA+CArB,CAAC,CAACK,IAAF,CAAO,4BAAP;AACGC,IADH;AAEK;AACL;AACA,GAJA;;AAMGC,MANH,CAMU,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAD,CACEC,OADH,CACW,aADX,EAC0BX,yBAD1B;AAEGY,aAFH;AAGGwB,iBAHH,CAGqB;AACjB,EAAEC,SAAS,EAAE,CAAC,GAAD,EAAM,GAAN,CAAb,EAAyBC,QAAQ,EAAE,CAAC,KAAD,CAAnC,EADiB;AAEjB,EAAED,SAAS,EAAE,CAAC,GAAD,CAAb,EAAoBC,QAAQ,EAAE,CAAC,GAAD,EAAM,KAAN,CAA9B,EAFiB;AAGjB,EAAED,SAAS,EAAE,CAAC,KAAD,EAAQ,GAAR,CAAb,EAA2BC,QAAQ,EAAE,CAAC,GAAD,CAArC,EAHiB;AAIjB,EAAED,SAAS,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,KAAX,CAAb,EAAgCC,QAAQ,EAAE,EAA1C,EAJiB,CAHrB,CAPJ;;;AAiBGtB,EAjBH,CAiBM,MAAMC,CAAN,IAAW;AACb,QAAM,EAAEC,WAAF,EAAemB,SAAf,EAA0BC,QAA1B,KAAuCrB,CAAC,CAACR,MAA/C;AACA,QAAMU,YAAY,GAAG,EAAEN,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EAArB;AACA,QAAMK,QAAQ,GAAGH,CAAC,CAACI,0BAAF,CAA6BH,WAA7B,EAA0CC,YAA1C,CAAjB;;AAEA,QAAMJ,GAAG,GAAGE,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAZ;AACA,QAAMqB,kBAAkB,GAAG;AACzBX,IAAAA,CAAC,EAAE,CAACY,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAFuB;AAGzBX,IAAAA,CAAC,EAAE,CAACW,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAJuB;AAKzBV,IAAAA,GAAG,EAAGU,CAAD,IAAeR,CAAC,CAACS,eAAF,CAAkBX,GAAlB,EAAuBU,CAAvB,CALK,EAA3B;;;AAQA,QAAM,EAAEE,OAAF,EAAWC,uBAAX,KAAuCX,CAAC,CAACY,aAAF,CAAgBX,WAAhB,CAA7C;;AAEA,OAAK,IAAIO,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGY,SAAS,CAACF,MAA9B,EAAsC,EAAEV,CAAxC,EAA2C;AACzCR,IAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwBR,YAAY,CAACkB,SAAS,CAACZ,CAAD,CAAV,CAApC,EAAoDD,kBAAkB,CAACa,SAAS,CAACZ,CAAD,CAAV,CAAtE;AACD;;AAEDR,EAAAA,CAAC,CAACa,WAAF,CAAcH,OAAd,EAAuBP,QAAvB;;AAEA,OAAK,IAAIK,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGa,QAAQ,CAACH,MAA7B,EAAqC,EAAEV,CAAvC,EAA0C;AACxCR,IAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwBR,YAAY,CAACmB,QAAQ,CAACb,CAAD,CAAT,CAApC,EAAmDD,kBAAkB,CAACc,QAAQ,CAACb,CAAD,CAAT,CAArE;AACD;;AAEDR,EAAAA,CAAC,CAACe,cAAF,CAAiBL,OAAjB;AACAC,EAAAA,uBAAuB,CAAC,IAAD,EAAO,IAAP,CAAvB;;AAEAX,EAAAA,CAAC,CAACgB,0BAAF,CAA6BlB,GAA7B,EAAkC,IAAIQ,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAlC;AACD,CA/CH;;AAiDArB,CAAC,CAACK,IAAF,CAAO,+BAAP;AACGC,IADH;AAEK;AACL;AACA,GAJA;;AAMGC,MANH,CAMU,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAD,CACEC,OADH,CACW,aADX,EAC0BX,yBAD1B,CAPJ;;AAUGgB,EAVH,CAUM,MAAMC,CAAN,IAAW;AACb,QAAM,EAAEC,WAAF,KAAkBD,CAAC,CAACR,MAA1B;AACA,QAAMW,QAAQ,GAAGH,CAAC,CAACI,0BAAF,CAA6BH,WAA7B,EAA0C,EAAEL,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EAA1C,CAAjB;;AAEA,QAAMA,GAAG,GAAGE,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAZ;AACA,QAAMqB,kBAAkB,GAAG;AACzBe,IAAAA,EAAE,EAAE,CAACd,CAAD;AACFR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAFuB;AAGzBV,IAAAA,GAAG,EAAGU,CAAD,IAAeR,CAAC,CAACS,eAAF,CAAkBX,GAAlB,EAAuBU,CAAvB,CAHK,EAA3B;;;AAMA,QAAM,EAAEE,OAAF,EAAWC,uBAAX,KAAuCX,CAAC,CAACY,aAAF,CAAgBX,WAAhB,CAA7C;AACAD,EAAAA,CAAC,CAACa,WAAF,CAAcH,OAAd,EAAuBP,QAAvB;;AAEAH,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACe,EAA9C;AACAtB,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACe,EAA9C;AACAtB,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACT,GAA9C;;AAEAE,EAAAA,CAAC,CAACe,cAAF,CAAiBL,OAAjB;AACAC,EAAAA,uBAAuB,CAAC,IAAD,EAAO,IAAP,CAAvB;;AAEAX,EAAAA,CAAC,CAACgB,0BAAF,CAA6BlB,GAA7B,EAAkC,IAAIQ,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAlC;AACD,CAhCH;;AAkCArB,CAAC,CAACK,IAAF,CAAO,0BAAP;AACGC,IADH;AAEK;AACL;AACA,GAJA;;AAMGC,MANH,CAMU,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAD,CACEC,OADH,CACW,aADX,EAC0BX,yBAD1B,CAPJ;;AAUGgB,EAVH,CAUM,MAAMC,CAAN,IAAW;AACb,QAAM,EAAEC,WAAF,KAAkBD,CAAC,CAACR,MAA1B;AACA,QAAMW,QAAQ,GAAGH,CAAC,CAACI,0BAAF,CAA6BH,WAA7B,EAA0C,EAAEL,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EAA1C,CAAjB;;AAEA,QAAMyB,MAAM,GAAGvB,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAC,CAAF,CAAf,CAAzB,EAA+CpB,YAA/C,CAAf;AACA,QAAMY,GAAG,GAAGE,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAZ;AACA,QAAMqB,kBAAkB,GAAG;AACzBX,IAAAA,CAAC,EAAE,CAACY,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAFuB;AAGzBX,IAAAA,CAAC,EAAE,CAACW,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAJuB;AAKzBgB,IAAAA,CAAC,EAAE,CAAChB,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CANuB;AAOzBe,IAAAA,MAAM,EAAGf,CAAD,IAAeR,CAAC,CAACS,eAAF,CAAkBc,MAAlB,EAA0Bf,CAA1B,CAPE;AAQzBV,IAAAA,GAAG,EAAGU,CAAD,IAAeR,CAAC,CAACS,eAAF,CAAkBX,GAAlB,EAAuBU,CAAvB,CARK,EAA3B;;;AAWA,QAAM,EAAEE,OAAF,EAAWC,uBAAX,KAAuCX,CAAC,CAACY,aAAF,CAAgBX,WAAhB,CAA7C;;AAEAD,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACiB,CAA9C;;AAEAxB,EAAAA,CAAC,CAACa,WAAF,CAAcH,OAAd,EAAuBP,QAAvB;;AAEAH,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACiB,CAA9C;AACAxB,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACX,CAA9C;;AAEAI,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACgB,MAA9C;;AAEAvB,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACV,CAA9C;AACAG,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACT,GAA9C;;AAEAE,EAAAA,CAAC,CAACe,cAAF,CAAiBL,OAAjB;AACAC,EAAAA,uBAAuB,CAAC,IAAD,EAAO,IAAP,CAAvB;;AAEAX,EAAAA,CAAC,CAACgB,0BAAF,CAA6BlB,GAA7B,EAAkC,IAAIQ,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAlC;AACAN,EAAAA,CAAC,CAACgB,0BAAF,CAA6BO,MAA7B,EAAqC,IAAIjB,UAAJ,CAAe,CAAC,CAAC,CAAF,CAAf,CAArC;AACD,CA9CH;;AAgDArB,CAAC,CAACK,IAAF,CAAO,sBAAP;AACGC,IADH,CACQ,mEADR;AAEGC,MAFH,CAEU,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAD,CACEC,OADH,CACW,aADX,EAC0BX,yBAD1B,CAHJ;;AAMGgB,EANH,CAMM,MAAMC,CAAN,IAAW;AACb,QAAM,EAAEC,WAAF,KAAkBD,CAAC,CAACR,MAA1B;AACA,QAAMiC,SAAS,GAAGzB,CAAC,CAACI,0BAAF,CAA6BH,WAA7B,EAA0C,EAAEL,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EAA1C,CAAlB;AACA,QAAM4B,SAAS,GAAG1B,CAAC,CAACI,0BAAF;AAChBH,EAAAA,WADgB;AAEhB,IAAEL,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,GAAG,EAAE,CAAnB,EAFgB;AAGhB,qBAHgB,CAAlB;;;AAMA,QAAM6B,IAAI,GAAG3B,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAb;AACA,QAAM0C,IAAI,GAAG5B,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAb;AACA,QAAMqB,kBAAkB,GAAG;AACzBX,IAAAA,CAAC,EAAE,CAACY,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAFuB;AAGzBX,IAAAA,CAAC,EAAE,CAACW,CAAD;AACDR,IAAAA,CAAC,CAACS,eAAF,CAAkBT,CAAC,CAACK,sBAAF,CAAyB,IAAIC,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAzB,EAA8CpB,YAA9C,CAAlB,EAA+EsB,CAA/E,CAJuB;AAKzBmB,IAAAA,IAAI,EAAGnB,CAAD,IAAeR,CAAC,CAACS,eAAF,CAAkBkB,IAAlB,EAAwBnB,CAAxB,CALI;AAMzBoB,IAAAA,IAAI,EAAGpB,CAAD,IAAeR,CAAC,CAACS,eAAF,CAAkBmB,IAAlB,EAAwBpB,CAAxB,CANI,EAA3B;;;AASA,QAAM,EAAEE,OAAF,EAAWC,uBAAX,KAAuCX,CAAC,CAACY,aAAF,CAAgBX,WAAhB,CAA7C;AACAD,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACX,CAA9C;AACAI,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACV,CAA9C;;AAEAG,EAAAA,CAAC,CAACa,WAAF,CAAcH,OAAd,EAAuBe,SAAvB;AACAzB,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACoB,IAA9C;AACA3B,EAAAA,CAAC,CAACe,cAAF,CAAiBL,OAAjB;;AAEAV,EAAAA,CAAC,CAACa,WAAF,CAAcH,OAAd,EAAuBgB,SAAvB;AACA1B,EAAAA,CAAC,CAACc,YAAF,CAAeJ,OAAf,EAAwB,CAAxB,EAA2BH,kBAAkB,CAACqB,IAA9C;AACA5B,EAAAA,CAAC,CAACe,cAAF,CAAiBL,OAAjB;;AAEAC,EAAAA,uBAAuB,CAAC,IAAD,EAAO,IAAP,CAAvB;;AAEAX,EAAAA,CAAC,CAACgB,0BAAF,CAA6BW,IAA7B,EAAmC,IAAIrB,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAnC;AACAN,EAAAA,CAAC,CAACgB,0BAAF,CAA6BY,IAA7B,EAAmC,IAAItB,UAAJ,CAAe,CAAC,CAAD,CAAf,CAAnC;AACD,CA1CH","sourcesContent":["export const description = `\nEnsure state is set correctly. Tries to stress state caching (setting different states multiple\ntimes in different orders) for setBindGroup and setPipeline.\n`;\n\nimport { makeTestGroup } from '../../../../../common/framework/test_group.js';\nimport { GPUConst } from '../../../../constants.js';\nimport { kProgrammableEncoderTypes } from '../../../../util/command_buffer_maker.js';\n\nimport { ProgrammableStateTest } from './programmable_state_test.js';\n\nexport const g = makeTestGroup(ProgrammableStateTest);\n\nconst kBufferUsage = GPUConst.BufferUsage.COPY_SRC | GPUConst.BufferUsage.STORAGE;\n\ng.test('bind_group_indices')\n  .desc(\n    `\n    Test that bind group indices can be declared in any order, regardless of their order in the shader.\n    - Test places the value of buffer a - buffer b into the out buffer, then reads the result.\n  `\n  )\n  .params(u =>\n    u //\n      .combine('encoderType', kProgrammableEncoderTypes)\n      .beginSubcases()\n      .combine('groupIndices', [\n        { a: 0, b: 1, out: 2 },\n        { a: 1, b: 2, out: 0 },\n        { a: 2, b: 0, out: 1 },\n        { a: 0, b: 2, out: 1 },\n        { a: 2, b: 1, out: 0 },\n        { a: 1, b: 0, out: 2 },\n      ])\n  )\n  .fn(async t => {\n    const { encoderType, groupIndices } = t.params;\n\n    const pipeline = t.createBindingStatePipeline(encoderType, groupIndices);\n\n    const out = t.makeBufferWithContents(new Int32Array([0]), kBufferUsage);\n    const bindGroupFactories = {\n      a: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([3]), kBufferUsage), i),\n      b: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([2]), kBufferUsage), i),\n      out: (i: number) => t.createBindGroup(out, i),\n    };\n\n    const { encoder, validateFinishAndSubmit } = t.createEncoder(encoderType);\n\n    t.setPipeline(encoder, pipeline);\n    t.setBindGroup(encoder, groupIndices.a, bindGroupFactories.a);\n    t.setBindGroup(encoder, groupIndices.b, bindGroupFactories.b);\n    t.setBindGroup(encoder, groupIndices.out, bindGroupFactories.out);\n    t.dispatchOrDraw(encoder);\n    validateFinishAndSubmit(true, true);\n\n    t.expectGPUBufferValuesEqual(out, new Int32Array([1]));\n  });\n\ng.test('bind_group_order')\n  .desc(\n    `\n    Test that the order in which you set the bind groups doesn't matter.\n  `\n  )\n  .params(u =>\n    u //\n      .combine('encoderType', kProgrammableEncoderTypes)\n      .beginSubcases()\n      .combine('setOrder', [\n        ['a', 'b', 'out'],\n        ['b', 'out', 'a'],\n        ['out', 'a', 'b'],\n        ['b', 'a', 'out'],\n        ['a', 'out', 'b'],\n        ['out', 'b', 'a'],\n      ] as const)\n  )\n  .fn(async t => {\n    const { encoderType, setOrder } = t.params;\n\n    const groupIndices = { a: 0, b: 1, out: 2 };\n    const pipeline = t.createBindingStatePipeline(encoderType, groupIndices);\n\n    const out = t.makeBufferWithContents(new Int32Array([0]), kBufferUsage);\n    const bindGroupFactories = {\n      a: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([3]), kBufferUsage), i),\n      b: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([2]), kBufferUsage), i),\n      out: (i: number) => t.createBindGroup(out, i),\n    };\n\n    const { encoder, validateFinishAndSubmit } = t.createEncoder(encoderType);\n    t.setPipeline(encoder, pipeline);\n\n    for (let i = 0; i < setOrder.length; ++i) {\n      t.setBindGroup(encoder, groupIndices[setOrder[i]], bindGroupFactories[setOrder[i]]);\n    }\n\n    t.dispatchOrDraw(encoder);\n    validateFinishAndSubmit(true, true);\n\n    t.expectGPUBufferValuesEqual(out, new Int32Array([1]));\n  });\n\ng.test('bind_group_before_pipeline')\n  .desc(\n    `\n    Test that setting bind groups prior to setting the pipeline is still valid.\n  `\n  )\n  .params(u =>\n    u //\n      .combine('encoderType', kProgrammableEncoderTypes)\n      .beginSubcases()\n      .combineWithParams([\n        { setBefore: ['a', 'b'], setAfter: ['out'] },\n        { setBefore: ['a'], setAfter: ['b', 'out'] },\n        { setBefore: ['out', 'b'], setAfter: ['a'] },\n        { setBefore: ['a', 'b', 'out'], setAfter: [] },\n      ] as const)\n  )\n  .fn(async t => {\n    const { encoderType, setBefore, setAfter } = t.params;\n    const groupIndices = { a: 0, b: 1, out: 2 };\n    const pipeline = t.createBindingStatePipeline(encoderType, groupIndices);\n\n    const out = t.makeBufferWithContents(new Int32Array([0]), kBufferUsage);\n    const bindGroupFactories = {\n      a: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([3]), kBufferUsage), i),\n      b: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([2]), kBufferUsage), i),\n      out: (i: number) => t.createBindGroup(out, i),\n    };\n\n    const { encoder, validateFinishAndSubmit } = t.createEncoder(encoderType);\n\n    for (let i = 0; i < setBefore.length; ++i) {\n      t.setBindGroup(encoder, groupIndices[setBefore[i]], bindGroupFactories[setBefore[i]]);\n    }\n\n    t.setPipeline(encoder, pipeline);\n\n    for (let i = 0; i < setAfter.length; ++i) {\n      t.setBindGroup(encoder, groupIndices[setAfter[i]], bindGroupFactories[setAfter[i]]);\n    }\n\n    t.dispatchOrDraw(encoder);\n    validateFinishAndSubmit(true, true);\n\n    t.expectGPUBufferValuesEqual(out, new Int32Array([1]));\n  });\n\ng.test('one_bind_group_multiple_slots')\n  .desc(\n    `\n    Test that a single bind group may be bound to more than one slot.\n  `\n  )\n  .params(u =>\n    u //\n      .combine('encoderType', kProgrammableEncoderTypes)\n  )\n  .fn(async t => {\n    const { encoderType } = t.params;\n    const pipeline = t.createBindingStatePipeline(encoderType, { a: 0, b: 1, out: 2 });\n\n    const out = t.makeBufferWithContents(new Int32Array([1]), kBufferUsage);\n    const bindGroupFactories = {\n      ab: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([3]), kBufferUsage), i),\n      out: (i: number) => t.createBindGroup(out, i),\n    };\n\n    const { encoder, validateFinishAndSubmit } = t.createEncoder(encoderType);\n    t.setPipeline(encoder, pipeline);\n\n    t.setBindGroup(encoder, 0, bindGroupFactories.ab);\n    t.setBindGroup(encoder, 1, bindGroupFactories.ab);\n    t.setBindGroup(encoder, 2, bindGroupFactories.out);\n\n    t.dispatchOrDraw(encoder);\n    validateFinishAndSubmit(true, true);\n\n    t.expectGPUBufferValuesEqual(out, new Int32Array([0]));\n  });\n\ng.test('bind_group_multiple_sets')\n  .desc(\n    `\n    Test that the last bind group set to a given slot is used when dispatching.\n  `\n  )\n  .params(u =>\n    u //\n      .combine('encoderType', kProgrammableEncoderTypes)\n  )\n  .fn(async t => {\n    const { encoderType } = t.params;\n    const pipeline = t.createBindingStatePipeline(encoderType, { a: 0, b: 1, out: 2 });\n\n    const badOut = t.makeBufferWithContents(new Int32Array([-1]), kBufferUsage);\n    const out = t.makeBufferWithContents(new Int32Array([0]), kBufferUsage);\n    const bindGroupFactories = {\n      a: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([3]), kBufferUsage), i),\n      b: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([2]), kBufferUsage), i),\n      c: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([5]), kBufferUsage), i),\n      badOut: (i: number) => t.createBindGroup(badOut, i),\n      out: (i: number) => t.createBindGroup(out, i),\n    };\n\n    const { encoder, validateFinishAndSubmit } = t.createEncoder(encoderType);\n\n    t.setBindGroup(encoder, 1, bindGroupFactories.c);\n\n    t.setPipeline(encoder, pipeline);\n\n    t.setBindGroup(encoder, 0, bindGroupFactories.c);\n    t.setBindGroup(encoder, 0, bindGroupFactories.a);\n\n    t.setBindGroup(encoder, 2, bindGroupFactories.badOut);\n\n    t.setBindGroup(encoder, 1, bindGroupFactories.b);\n    t.setBindGroup(encoder, 2, bindGroupFactories.out);\n\n    t.dispatchOrDraw(encoder);\n    validateFinishAndSubmit(true, true);\n\n    t.expectGPUBufferValuesEqual(out, new Int32Array([1]));\n    t.expectGPUBufferValuesEqual(badOut, new Int32Array([-1]));\n  });\n\ng.test('compatible_pipelines')\n  .desc('Test that bind groups can be shared between compatible pipelines.')\n  .params(u =>\n    u //\n      .combine('encoderType', kProgrammableEncoderTypes)\n  )\n  .fn(async t => {\n    const { encoderType } = t.params;\n    const pipelineA = t.createBindingStatePipeline(encoderType, { a: 0, b: 1, out: 2 });\n    const pipelineB = t.createBindingStatePipeline(\n      encoderType,\n      { a: 0, b: 1, out: 2 },\n      'a.value + b.value'\n    );\n\n    const outA = t.makeBufferWithContents(new Int32Array([0]), kBufferUsage);\n    const outB = t.makeBufferWithContents(new Int32Array([0]), kBufferUsage);\n    const bindGroupFactories = {\n      a: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([3]), kBufferUsage), i),\n      b: (i: number) =>\n        t.createBindGroup(t.makeBufferWithContents(new Int32Array([2]), kBufferUsage), i),\n      outA: (i: number) => t.createBindGroup(outA, i),\n      outB: (i: number) => t.createBindGroup(outB, i),\n    };\n\n    const { encoder, validateFinishAndSubmit } = t.createEncoder(encoderType);\n    t.setBindGroup(encoder, 0, bindGroupFactories.a);\n    t.setBindGroup(encoder, 1, bindGroupFactories.b);\n\n    t.setPipeline(encoder, pipelineA);\n    t.setBindGroup(encoder, 2, bindGroupFactories.outA);\n    t.dispatchOrDraw(encoder);\n\n    t.setPipeline(encoder, pipelineB);\n    t.setBindGroup(encoder, 2, bindGroupFactories.outB);\n    t.dispatchOrDraw(encoder);\n\n    validateFinishAndSubmit(true, true);\n\n    t.expectGPUBufferValuesEqual(outA, new Int32Array([1]));\n    t.expectGPUBufferValuesEqual(outB, new Int32Array([5]));\n  });\n"],"file":"state_tracking.spec.js"}