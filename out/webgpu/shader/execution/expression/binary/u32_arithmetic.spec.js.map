{"version":3,"file":"u32_arithmetic.spec.js","names":["description","makeTestGroup","GPUTest","TypeU32","TypeVec","fullU32Range","sparseU32Range","vectorU32Range","makeCaseCache","allInputSources","generateBinaryToU32Cases","generateU32VectorBinaryToVectorCases","generateVectorU32BinaryToVectorCases","run","binary","g","d","addition","x","y","subtraction","multiplication","Math","imul","division_non_const","division_const","undefined","remainder_non_const","remainder_const","multiplication_scalar_vector2","multiplication_scalar_vector3","multiplication_scalar_vector4","multiplication_vector2_scalar","multiplication_vector3_scalar","multiplication_vector4_scalar","test","specURL","desc","params","u","combine","fn","t","cases","get","inputSource","vec_size","vectorize_rhs","vec_type","vectorize_lhs"],"sources":["../../../../../../src/webgpu/shader/execution/expression/binary/u32_arithmetic.spec.ts"],"sourcesContent":["export const description = `\nExecution Tests for the u32 arithmetic binary expression operations\n`;\n\nimport { makeTestGroup } from '../../../../../common/framework/test_group.js';\nimport { GPUTest } from '../../../../gpu_test.js';\nimport { TypeU32, TypeVec } from '../../../../util/conversion.js';\nimport { fullU32Range, sparseU32Range, vectorU32Range } from '../../../../util/math.js';\nimport { makeCaseCache } from '../case_cache.js';\nimport {\n  allInputSources,\n  generateBinaryToU32Cases,\n  generateU32VectorBinaryToVectorCases,\n  generateVectorU32BinaryToVectorCases,\n  run,\n} from '../expression.js';\n\nimport { binary } from './binary.js';\n\nexport const g = makeTestGroup(GPUTest);\n\nexport const d = makeCaseCache('binary/u32_arithmetic', {\n  addition: () => {\n    return generateBinaryToU32Cases(fullU32Range(), fullU32Range(), (x, y) => {\n      return x + y;\n    });\n  },\n  subtraction: () => {\n    return generateBinaryToU32Cases(fullU32Range(), fullU32Range(), (x, y) => {\n      return x - y;\n    });\n  },\n  multiplication: () => {\n    return generateBinaryToU32Cases(fullU32Range(), fullU32Range(), (x, y) => {\n      return Math.imul(x, y);\n    });\n  },\n  division_non_const: () => {\n    return generateBinaryToU32Cases(fullU32Range(), fullU32Range(), (x, y) => {\n      if (y === 0) {\n        return x;\n      }\n      return x / y;\n    });\n  },\n  division_const: () => {\n    return generateBinaryToU32Cases(fullU32Range(), fullU32Range(), (x, y) => {\n      if (y === 0) {\n        return undefined;\n      }\n      return x / y;\n    });\n  },\n  remainder_non_const: () => {\n    return generateBinaryToU32Cases(fullU32Range(), fullU32Range(), (x, y) => {\n      if (y === 0) {\n        return 0;\n      }\n      return x % y;\n    });\n  },\n  remainder_const: () => {\n    return generateBinaryToU32Cases(fullU32Range(), fullU32Range(), (x, y) => {\n      if (y === 0) {\n        return undefined;\n      }\n      return x % y;\n    });\n  },\n  multiplication_scalar_vector2: () => {\n    return generateU32VectorBinaryToVectorCases(sparseU32Range(), vectorU32Range(2), (x, y) => {\n      return Math.imul(x, y);\n    });\n  },\n  multiplication_scalar_vector3: () => {\n    return generateU32VectorBinaryToVectorCases(sparseU32Range(), vectorU32Range(3), (x, y) => {\n      return Math.imul(x, y);\n    });\n  },\n  multiplication_scalar_vector4: () => {\n    return generateU32VectorBinaryToVectorCases(sparseU32Range(), vectorU32Range(4), (x, y) => {\n      return Math.imul(x, y);\n    });\n  },\n  multiplication_vector2_scalar: () => {\n    return generateVectorU32BinaryToVectorCases(vectorU32Range(2), sparseU32Range(), (x, y) => {\n      return Math.imul(x, y);\n    });\n  },\n  multiplication_vector3_scalar: () => {\n    return generateVectorU32BinaryToVectorCases(vectorU32Range(3), sparseU32Range(), (x, y) => {\n      return Math.imul(x, y);\n    });\n  },\n  multiplication_vector4_scalar: () => {\n    return generateVectorU32BinaryToVectorCases(vectorU32Range(4), sparseU32Range(), (x, y) => {\n      return Math.imul(x, y);\n    });\n  },\n});\n\ng.test('addition')\n  .specURL('https://www.w3.org/TR/WGSL/#arithmetic-expr')\n  .desc(\n    `\nExpression: x + y\n`\n  )\n  .params(u =>\n    u.combine('inputSource', allInputSources).combine('vectorize', [undefined, 2, 3, 4] as const)\n  )\n  .fn(async t => {\n    const cases = await d.get('addition');\n    await run(t, binary('+'), [TypeU32, TypeU32], TypeU32, t.params, cases);\n  });\n\ng.test('subtraction')\n  .specURL('https://www.w3.org/TR/WGSL/#arithmetic-expr')\n  .desc(\n    `\nExpression: x - y\n`\n  )\n  .params(u =>\n    u.combine('inputSource', allInputSources).combine('vectorize', [undefined, 2, 3, 4] as const)\n  )\n  .fn(async t => {\n    const cases = await d.get('subtraction');\n    await run(t, binary('-'), [TypeU32, TypeU32], TypeU32, t.params, cases);\n  });\n\ng.test('multiplication')\n  .specURL('https://www.w3.org/TR/WGSL/#arithmetic-expr')\n  .desc(\n    `\nExpression: x * y\n`\n  )\n  .params(u =>\n    u.combine('inputSource', allInputSources).combine('vectorize', [undefined, 2, 3, 4] as const)\n  )\n  .fn(async t => {\n    const cases = await d.get('multiplication');\n    await run(t, binary('*'), [TypeU32, TypeU32], TypeU32, t.params, cases);\n  });\n\ng.test('division')\n  .specURL('https://www.w3.org/TR/WGSL/#arithmetic-expr')\n  .desc(\n    `\nExpression: x / y\n`\n  )\n  .params(u =>\n    u.combine('inputSource', allInputSources).combine('vectorize', [undefined, 2, 3, 4] as const)\n  )\n  .fn(async t => {\n    const cases = await d.get(\n      t.params.inputSource === 'const' ? 'division_const' : 'division_non_const'\n    );\n    await run(t, binary('/'), [TypeU32, TypeU32], TypeU32, t.params, cases);\n  });\n\ng.test('remainder')\n  .specURL('https://www.w3.org/TR/WGSL/#arithmetic-expr')\n  .desc(\n    `\nExpression: x % y\n`\n  )\n  .params(u =>\n    u.combine('inputSource', allInputSources).combine('vectorize', [undefined, 2, 3, 4] as const)\n  )\n  .fn(async t => {\n    const cases = await d.get(\n      t.params.inputSource === 'const' ? 'remainder_const' : 'remainder_non_const'\n    );\n    await run(t, binary('%'), [TypeU32, TypeU32], TypeU32, t.params, cases);\n  });\n\ng.test('multiplication_scalar_vector')\n  .specURL('https://www.w3.org/TR/WGSL/#arithmetic-expr')\n  .desc(\n    `\nExpression: x * y\n`\n  )\n  .params(u =>\n    u.combine('inputSource', allInputSources).combine('vectorize_rhs', [2, 3, 4] as const)\n  )\n  .fn(async t => {\n    const vec_size = t.params.vectorize_rhs;\n    const vec_type = TypeVec(vec_size, TypeU32);\n    const cases = await d.get(`multiplication_scalar_vector${vec_size}`);\n    await run(t, binary('*'), [TypeU32, vec_type], vec_type, t.params, cases);\n  });\n\ng.test('multiplication_vector_scalar')\n  .specURL('https://www.w3.org/TR/WGSL/#arithmetic-expr')\n  .desc(\n    `\nExpression: x * y\n`\n  )\n  .params(u =>\n    u.combine('inputSource', allInputSources).combine('vectorize_lhs', [2, 3, 4] as const)\n  )\n  .fn(async t => {\n    const vec_size = t.params.vectorize_lhs;\n    const vec_type = TypeVec(vec_size, TypeU32);\n    const cases = await d.get(`multiplication_vector${vec_size}_scalar`);\n    await run(t, binary('*'), [vec_type, TypeU32], vec_type, t.params, cases);\n  });\n"],"mappings":"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"}